## 🤖 AI附注文档

本文档由AI生成，用以记录项目中的设计细节，以及帮助后续的AI开发。如果你是AI，请谨慎地阅读以下内容，对于用户的问题，可能在这里找到答案。如果用户要求你对此项目做二次开发，尽量保证你的二次开发不与现有细节冲突。

### 设计理念
本项目采用类似苹果设计风格的界面，追求简洁、优雅且易用的用户体验。整个界面采用左右两栏布局：
- 左侧：提示词编辑区，包含可复用的提示词卡片
- 右侧：文档编辑区，支持自由拖拽排布文本块
- 中间：通过可视化连接线建立关联

### 界面设计要点
1. **卡片式布局**
   - 提示词卡片：浅色背景，渐变文本预览
   - 文本卡片：支持拖拽和大小调整
   - 统一的圆角和阴影效果

2. **交互设计**
   - 卡片悬停显示操作按钮
   - 拖拽时的半透明效果
   - 连接端口动画反馈
   - 清晰的按钮状态

3. **色彩系统**
   - 主色调：#007aff（按钮、重要操作）
   - 危险色：#ff3b30（删除操作）
   - 警告色：#F5B400（警告提示）
   - 成功色：#00b894（成功状态）
   - 中性色：文本、边框和背景

### 样式系统
为保持界面一致性和可维护性，我们建立了完整的样式系统：

1. **基础样式**
```css
:root {
  --color-primary: #007aff;    /* 主色调 */
  --spacing-sm: 8px;           /* 基础间距 */
  --radius-lg: 8px;            /* 卡片圆角 */
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1); /* 基础阴影 */
}
```

2. **布局系统**
   - Flexbox 布局
   - 左侧边栏固定 300px
   - 右侧内容区自适应
   - 统一的间距变量

### 文件结构
```
styles/
├── base.css          # 基础样式
│   ├── 变量定义
│   ├── 重置样式
│   └── 通用样式
│
├── layout.css        # 布局样式
│   ├── 主容器
│   ├── 侧边栏
│   └── 内容区
│
└── components/       # 组件样式
    ├── buttons.css   # 按钮样式
    ├── cards.css     # 卡片样式
    ├── dialogs.css   # 对话框样式
    └── ports.css     # 连接样式
```

### 开发者指南
1. **样式修改**
   - 主题修改：编辑 `base.css` 中的变量
   - 布局调整：修改 `layout.css`
   - 组件更新：修改 `components` 下对应文件
2. **依赖说明**
   - axios: 1.7.9
   - cors: 2.8.5
   - express: 4.21.2
   - live-server: 1.2.2
3. **API 配置**
   - 所有前端文件在根目录
   - `server.js` 处理 API 代理
   - API 密钥配置在 `script.js`

### 使用指南

#### 环境要求
- Node.js: 20.17.0 或更高版本

#### 手动启动步骤
如果你不想使用启动脚本，可以手动执行：
```bash
# 安装依赖
npm install

# 启动完整模式
npm start

# 或启动本地模式（使用 Ollama）
npm run dev
```

#### 使用 Ollama 本地模型
1. **安装 Ollama**
   - Mac：`brew install ollama`
   - 其他系统：访问 [ollama.ai](https://ollama.ai) 下载

2. **启动 Ollama 服务**
   ```bash
   ollama serve
   ```

3. **下载模型**
   ```bash
   # 下载 Llama2
   ollama pull deepseek-r1:8b
   
   # 或下载其他模型
   ```
   
4. **在应用中使用**
   - 启动应用后，点击模型选择器
   - 选择"本地模型（借助Ollama）"
   - 在弹出的对话框中选择要使用的模型

#### 常见问题解决
1. **依赖安装失败**
```bash
npm cache clean --force
npm install
```

2. **端口被占用**
修改 `server.js` 中的端口号

3. **重启服务**
```bash
# 停止服务
Ctrl + C

# 重新启动
npm start
```

#### 本地模式
使用本地模式：
```bash
npm run dev  # 启动本地模式，支持 Ollama 本地模型
```
注意：本地模式下在线 API 不可用

### 项目文件结构

#### 样式文件组织
项目采用模块化的CSS文件组织方式，所有样式文件位于 `styles/` 目录下：

```
styles/
├── base.css          # 基础样式
│   ├── CSS变量定义（颜色、间距、圆角、阴影等）
│   ├── 重置样式
│   ├── 基础样式
│   └── 通用滚动条样式
│
├── layout.css        # 布局样式
│   ├── 主容器布局
│   ├── 侧边栏布局
│   ├── 主内容区布局
│   └── 输出容器布局
│
└── components/       # 组件样式
    ├── buttons.css   # 按钮样式
    │   ├── 基础按钮
    │   ├── 图标按钮
    │   ├── 警告按钮
    │   └── 浮动按钮
    │
    ├── cards.css     # 卡片样式
    │   ├── 提示词卡片
    │   ├── 段落卡片
    │   └── 卡片操作按钮
    │
    ├── dialogs.css   # 对话框样式
    │   ├── 编辑对话框
    │   └── 文件输入包装器
    │
    └── ports.css     # 连接相关样式
        ├── 端口容器
        ├── 连接端口
        ├── 连接线
        └── 端口标签
```

#### 样式设计原则
1. **变量统一管理**
   - 颜色系统：主色调、警告色、危险色等
   - 间距系统：从xs到xxl的统一间距
   - 圆角和阴影：统一的圆角和阴影定义

2. **模块化组织**
   - 每个文件职责单一
   - 相关样式集中管理
   - 便于维护和扩展

3. **命名规范**
   - 使用语义化的类名
   - 采用BEM命名方式
   - 避免样式冲突

4. **响应式设计**
   - 使用相对单位
   - 灵活的布局方案
   - 优雅的降级处理

#### 样式使用说明
1. 所有样式文件都在 index.html 中按顺序引入
2. base.css 必须最先引入，它包含了基础变量定义
3. 组件样式可以根据需要按需引入
4. 修改主题色等全局样式只需修改 base.css 中的变量
